<launch>

  <param name="/use_sim_time" value="true" />
  <!-- 启动机器人和Gazebo环境 -->
  <include file="$(find my_robot_description)/launch/spawn_robot.launch"/>
  
  <!-- 启动机器人状态发布器（修改发布频率，明确节点名称） -->
  <!--<node name="my_robot_state_pub"
        pkg="robot_state_publisher" 
        type="robot_state_publisher">
    <param name="publish_frequency" value="1.0"/>
  </node>-->
  
  <!-- 手动发布所有静态TF（与URDF关节参数严格一致） -->



<!-- 2. base_link → left_axis（对应URDF中的left_axis_joint） -->
<node pkg="tf2_ros" type="static_transform_publisher" name="base_to_left_axis_tf"
      args="0 0.2 0 0 0 0 base_link left_axis" output="screen">
  <param name="publish_frequency" value="1.0"/>
</node>

<!-- 3. base_link → right_axis（对应URDF中的right_axis_joint） -->
<node pkg="tf2_ros" type="static_transform_publisher" name="base_to_right_axis_tf"
      args="0 -0.2 0 0 0 0 base_link right_axis" output="screen">
  <param name="publish_frequency" value="1.0"/>
</node>

<!-- 4. base_link → laser_link（对应URDF中的joint_laser） -->
<node pkg="tf2_ros" type="static_transform_publisher" name="base_to_laser_tf"
      args="0 0 0.1 0 0 0 base_link laser_link" output="screen">
  <param name="publish_frequency" value="1.0"/>
</node>

  
  <!-- 启动SLAM用于建图 -->
  <node pkg="gmapping" type="slam_gmapping" name="my_slam_gmapping" output="screen">
    <param name="base_frame" value="base_link"/>
    <param name="odom_frame" value="odom"/>
    <param name="map_update_interval" value="20.0"/>
    <param name="maxUrange" value="5.0"/>
    <param name="sigma" value="0.05"/>
    <param name="kernelSize" value="1"/>
    <param name="lstep" value="0.05"/>
    <param name="astep" value="0.05"/>
    <param name="iterations" value="5"/>
    <param name="lsigma" value="0.075"/>
    <param name="ogain" value="3.0"/>
    <param name="lskip" value="0"/>
    <param name="srr" value="0.1"/>
    <param name="srt" value="0.2"/>
    <param name="str" value="0.1"/>
    <param name="stt" value="0.2"/>
    <param name="linearUpdate" value="0.8"/>
    <param name="angularUpdate" value="0.6"/>
    <param name="temporalUpdate" value="-1.0"/>
    <param name="resampleThreshold" value="0.5"/>
    <param name="particles" value="30"/>
    <param name="xmin" value="-10.0"/>
    <param name="ymin" value="-10.0"/>
    <param name="xmax" value="10.0"/>
    <param name="ymax" value="10.0"/>
    <param name="delta" value="0.05"/>
    <param name="llsamplerange" value="0.01"/>
    <param name="llsamplestep" value="0.01"/>
    <param name="lasamplerange" value="0.005"/>
    <param name="lasamplestep" value="0.005"/>
  </node>

  <!-- 启动导航 -->
  <include file="$(find my_robot_description)/launch/navigation.launch"/>
  
  <!-- 启动rviz可视化 -->
  <node pkg="rviz" type="rviz" name="my_rviz"
        args="-d $(find my_robot_description)/rviz/navigation.rviz"/>
</launch>
